graph TD
    START[System Tables Data] --> CTE[Shared CTEs]
    
    CTE --> DELTA[delta_usage<br/>Delta Tables %]
    CTE --> DLT[dlt_usage<br/>DLT Compute %]
    CTE --> SERVERLESS[serverless_usage<br/>Serverless %]
    CTE --> PHOTON[photon_usage<br/>Photon Queries %]
    CTE --> CLUSTER[cluster_metrics<br/>Cluster Configs]
    CTE --> WAREHOUSE[warehouse_metrics<br/>Warehouse Configs]
    CTE --> TABLES[table_metrics<br/>Table Stats]
    
    DELTA --> METRIC1[R-01-01: Delta Format<br/>Score: 85.5%<br/>Threshold: 80%<br/>Status: Pass]
    DLT --> METRIC2[R-01-03: DLT Usage<br/>Score: 25.0%<br/>Threshold: 30%<br/>Status: Fail]
    SERVERLESS --> METRIC3[R-01-06: Serverless<br/>Score: 60.0%<br/>Threshold: 50%<br/>Status: Pass]
    CLUSTER --> METRIC4[R-03-01: Auto-Scale Clusters<br/>Score: 75.0%<br/>Threshold: 80%<br/>Status: Fail]
    WAREHOUSE --> METRIC5[R-03-02: Auto-Scale Warehouses<br/>Score: 90.0%<br/>Threshold: 80%<br/>Status: Pass]
    
    METRIC1 --> AGG1[Principle: Design for failure<br/>4 metrics, 2 Pass = 50%]
    METRIC2 --> AGG1
    METRIC3 --> AGG1
    
    METRIC4 --> AGG2[Principle: Autoscaling<br/>2 metrics, 1 Pass = 50%]
    METRIC5 --> AGG2
    
    AGG1 --> TOTAL[Reliability Overall<br/>8 metrics, 3 Pass = 37.5%]
    AGG2 --> TOTAL
    
    TOTAL --> DISPLAY[Dashboard Display<br/>Completion Percentage]