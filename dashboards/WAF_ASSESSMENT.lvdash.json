{"datasets":[{"name":"303a6758","displayName":"Count of Tables","query":"SELECT COUNT(*) FROM system.information_schema.tables;"},{"name":"f5bf425c","displayName":"Count of Volumes","query":"SELECT COUNT(*) FROM system.information_schema.volumes;"},{"name":"5fdcd556","displayName":"Count of Functions","query":"SELECT COUNT(*) FROM system.information_schema.routines;"},{"name":"a92ace17","displayName":"Count of Unused Tables","query":"SELECT \n  COUNT(DISTINCT CONCAT(ist.table_catalog, '.', ist.table_schema, '.', ist.table_name)) AS full_name_count\nFROM \n  system.information_schema.tables ist\n  LEFT JOIN \n    (SELECT \n       tl.source_table_catalog,\n       tl.source_table_schema,\n       tl.source_table_name\n     FROM \n       system.access.table_lineage tl\n     WHERE \n       tl.event_time BETWEEN :date_range_start AND :date_range_end\n       AND tl.source_type IN ('TABLE', 'STREAMING_TABLE')\n    ) tl\n    ON \n      tl.source_table_catalog = ist.table_catalog \n      AND tl.source_table_schema = ist.table_schema \n      AND tl.source_table_name = ist.table_name\nWHERE\n  tl.source_table_catalog IS NULL;","parameters":[{"displayName":"date_range_start","keyword":"date_range_start","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now-30d/d"}]}}},{"displayName":"date_range_end","keyword":"date_range_end","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now/s"}]}}}]},{"name":"55e66413","displayName":"Count of Tables with Usage","query":"SELECT \n  COUNT(DISTINCT CONCAT(source_table_catalog, '.', source_table_schema, '.', source_table_name)) AS distinct_tables\nFROM \n  system.access.table_lineage\nWHERE \n  event_time BETWEEN :date_range_start AND :date_range_end\n  AND source_table_full_name IS NOT NULL\n  AND source_type IN ('TABLE', 'STREAMING_TABLE');","parameters":[{"displayName":"date_range_start","keyword":"date_range_start","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now-30d/d"}]}}},{"displayName":"date_range_end","keyword":"date_range_end","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now/s"}]}}}]},{"name":"90d7e6f1","displayName":"Count of Unique Users with Table Read/Write Event","query":"SELECT \n  COUNT(DISTINCT created_by) AS distinct_users\n\nFROM \n  system.access.table_lineage AS tl\n\nWHERE \n  event_time >= :date_range_start\n  AND event_time <= :date_range_end\n  AND (source_table_full_name IS NOT NULL);","parameters":[{"displayName":"date_range_start","keyword":"date_range_start","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now-30d/d"}]}}},{"displayName":"date_range_end","keyword":"date_range_end","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now/s"}]}}}]},{"name":"628c2773","displayName":"Count of Unsecured Tables","query":"SELECT \n    COUNT(DISTINCT CONCAT(TABLE_CATALOG, '.', TABLE_SCHEMA, '.', TABLE_NAME)) AS full_name_count\nFROM \n    system.information_schema.table_privileges\nWHERE \n    grantee = 'account users' \n    AND privilege_type = 'SELECT';"},{"name":"1f951287","displayName":"Count of Sensitive Tables","query":"SELECT COUNT(DISTINCT CONCAT(table_catalog, '.', table_schema, '.', table_name)) AS distinct_table_count\nFROM (\n    SELECT \n        table_catalog, table_schema, table_name\n    FROM \n        system.information_schema.column_masks\n\n    UNION\n\n    SELECT \n        table_catalog, table_schema, table_name\n    FROM \n        system.information_schema.row_filters\n) AS combined;\n"},{"name":"913b3827","displayName":"Pie Chart of Tagged vs. Untagged Tables","query":"WITH tagged_count AS (\n    SELECT COUNT(*) AS count FROM system.information_schema.table_tags\n)\nSELECT 'Tagged' AS label, count \nFROM tagged_count\nUNION ALL\nSELECT 'Untagged' AS label, \n       (SELECT COUNT(*) FROM system.information_schema.tables) - count \nFROM tagged_count;"},{"name":"788914b8","displayName":"Bar Chart of Popular Tags","query":"SELECT \n  tag_name,\n  COUNT(*) AS usage_count\nFROM \n  system.information_schema.table_tags\nWHERE \n  tag_name IS NOT NULL\nGROUP BY \n  tag_name\nORDER BY \n  usage_count DESC\nLIMIT 10;"},{"name":"8d97349c","displayName":"Usage Over Last Year","query":"SELECT \n    DATE_TRUNC('month', event_time) AS usage_date,\n    COUNT(*) AS usage_count\nFROM \n    system.access.table_lineage\nWHERE \n    (event_time >= :date_range_start AND event_time <= :date_range_end )\nGROUP BY \n    usage_date\nORDER BY\n    usage_date;","parameters":[{"displayName":"date_range_start","keyword":"date_range_start","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now-12M/M"}]}}},{"displayName":"date_range_end","keyword":"date_range_end","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now/s"}]}}}]},{"name":"763a2da9","displayName":"Most Popular Tables with Staleness","query":"WITH TableReads AS (\n    SELECT\n        CONCAT(source_table_catalog, '.', source_table_schema, '.', source_table_name) AS table_full_name,\n        COUNT(*) AS read_count\n    FROM\n        system.access.table_lineage\n    WHERE\n        source_table_catalog IS NOT NULL\n        AND :date_range_start <= event_date AND event_date <= :date_range_end\n    GROUP BY\n        table_full_name\n),\nLatestTargetDate AS (\n    SELECT\n        CONCAT(target_table_catalog, '.', target_table_schema, '.', target_table_name) AS table_full_name,\n        MAX(event_date) AS latest_target_date\n    FROM\n        system.access.table_lineage\n    WHERE\n        target_table_catalog IS NOT NULL\n    GROUP BY\n        table_full_name\n)\nSELECT\n    tr.table_full_name,\n    tr.read_count,\n    COALESCE(ltd.latest_target_date, 'N/A') AS latest_target_date\nFROM\n    TableReads tr\nLEFT JOIN\n    LatestTargetDate ltd ON tr.table_full_name = ltd.table_full_name\nORDER BY\n    tr.read_count DESC\nLIMIT 10;\n","parameters":[{"displayName":"date_range_start","keyword":"date_range_start","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now-30d/d"}]}}},{"displayName":"date_range_end","keyword":"date_range_end","dataType":"DATETIME","defaultSelection":{"values":{"dataType":"DATETIME","values":[{"value":"now/s"}]}}}]},{"name":"5ed9b6e5","displayName":"Score","query":"SELECT \n  \"RAW Data Governance\",\n  CASE \n    WHEN (SELECT COUNT(*) FROM system.information_schema.volumes) > 10 \n    THEN \"8/10\" \n    WHEN (SELECT COUNT(*) FROM system.information_schema.volumes) > 5 \n    THEN \"5/10\" \n    ELSE \"0\" \n  END\n  as SCORE\n\n  UNION\n\n  SELECT \n  \"Procedural Governance\",\n  CASE \n    WHEN (SELECT COUNT(*) FROM system.information_schema.routines) > 10 \n    THEN \"10/10\" \n    WHEN (SELECT COUNT(*) FROM system.information_schema.routines) > 5 \n    THEN \"5/10\" \n    ELSE \"0/10\" \n  END\n\n  UNION\n\n--    SELECT \n--   \"Permission Coverage\",\n--   CASE \n--     WHEN (SELECT \n--     COUNT(DISTINCT CONCAT(TABLE_CATALOG, '.', TABLE_SCHEMA, '.', TABLE_NAME))t\n-- FROM \n--     system.information_schema.table_privileges \n-- WHERE \n--     grantee = 'account users' \n--     AND privilege_type = 'SELECT' limit 10) > 1\n--     THEN\n--     0 \n\n--     ELSE 10 \n--   END\n\n--   UNION \n\n  SELECT \n  \"TAG Governance\",\n  CASE \n    WHEN (SELECT COUNT(*) FROM system.information_schema.column_tags) > 10 \n    THEN \"10/10\" \n    WHEN (SELECT COUNT(*) FROM system.information_schema.column_tags) > 5 \n    THEN \"5/10\" \n    ELSE \"0/10\" \n  END\n\n\n"},{"name":"1eab9fe1","displayName":"waf_controls_g","query":"SELECT\n  waf_id,\n  pillar,\n  principle,\n  description,\n  check_type,\n  source_object,\n  CASE \n    WHEN waf_id = 'DG-01-03' AND EXISTS (\n      SELECT 1 FROM system.access.table_lineage LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'DG-01-04' AND EXISTS (\n      SELECT 1 FROM system.information_schema.columns WHERE comment IS NOT NULL LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'DG-01-05' AND EXISTS (\n      SELECT 1 FROM system.information_schema.table_tags LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'DG-02-01' AND EXISTS (\n      SELECT 1 FROM system.information_schema.row_filters LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'DG-02-02' AND EXISTS (\n      SELECT 1 FROM system.access.audit LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'DG-02-03' AND EXISTS (\n      SELECT 1 FROM system.marketplace.listing_access_events LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'DG-03-02' AND EXISTS (\n      SELECT 1 FROM system.information_schema.tables \n      WHERE table_name LIKE '%_drift_metrics' OR table_name LIKE '%_profile_metrics' \n      LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'DG-03-03' AND EXISTS (\n      SELECT 1 FROM system.information_schema.tables \n      WHERE table_type = 'BASE TABLE'\n      LIMIT 1\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS implemented\nFROM (\n  SELECT * FROM VALUES\n    ('DG-01-03', 'Data & AI Governance', 'Unify data and AI management', 'Track data and AI lineage', 'AUTO', 'system.access.table_lineage'),\n    ('DG-01-04', 'Data & AI Governance', 'Unify data and AI management', 'Add comments to metadata', 'AUTO', 'system.information_schema.columns'),\n    ('DG-01-05', 'Data & AI Governance', 'Unify data and AI management', 'Enable easy data discovery', 'AUTO', 'system.information_schema.table_tags'),\n    ('DG-02-01', 'Data & AI Governance', 'Unify data and AI security', 'Centralize access control (row/column level)', 'AUTO', 'system.information_schema.row_filters'),\n    ('DG-02-02', 'Data & AI Governance', 'Unify data and AI security', 'Configure audit logging', 'AUTO', 'system.access.audit'),\n    ('DG-02-03', 'Data & AI Governance', 'Unify data and AI security', 'Audit data platform events', 'AUTO', 'system.marketplace.listing_access_events'),\n    ('DG-03-02', 'Data & AI Governance', 'Establish data quality standards', 'Use data quality tools and profiling', 'PATTERN', 'system.information_schema.tables'),\n    ('DG-03-03', 'Data & AI Governance', 'Establish data quality standards', 'Enforce standardized data formats', 'AUTO', 'system.information_schema.tables')\n  AS waf(waf_id, pillar, principle, description, check_type, source_object)\n) waf\n"},{"name":"95258030","displayName":"waf_principal_percentage_g","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    principle,\n    CASE \n      WHEN waf_id = 'DG-01-03' AND EXISTS (\n        SELECT 1 FROM system.access.table_lineage LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-01-04' AND EXISTS (\n        SELECT 1 FROM system.information_schema.columns WHERE comment IS NOT NULL LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-01-05' AND EXISTS (\n        SELECT 1 FROM system.information_schema.table_tags LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-02-01' AND EXISTS (\n        SELECT 1 FROM system.information_schema.row_filters LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-02-02' AND EXISTS (\n        SELECT 1 FROM system.access.audit LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-02-03' AND EXISTS (\n        SELECT 1 FROM system.marketplace.listing_access_events LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-03-02' AND EXISTS (\n        SELECT 1 FROM system.information_schema.tables \n        WHERE table_name LIKE '%_drift_metrics' OR table_name LIKE '%_profile_metrics' \n        LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-03-03' AND EXISTS (\n        SELECT 1 FROM system.information_schema.tables \n        WHERE table_type = 'BASE TABLE'\n        LIMIT 1\n      ) THEN 'Yes'\n      ELSE 'No'\n    END AS implemented\n  FROM (\n    SELECT * FROM VALUES\n      ('DG-01-03', 'Unify data and AI management'),\n      ('DG-01-04', 'Unify data and AI management'),\n      ('DG-01-05', 'Unify data and AI management'),\n      ('DG-02-01', 'Unify data and AI security'),\n      ('DG-02-02', 'Unify data and AI security'),\n      ('DG-02-03', 'Unify data and AI security'),\n      ('DG-03-02', 'Establish data quality standards'),\n      ('DG-03-03', 'Establish data quality standards')\n    AS waf(waf_id, principle)\n  )\n)\n\nSELECT\n  principle,\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status\nGROUP BY principle\nORDER BY principle\n"},{"name":"920a8759","displayName":"total_percentage_g","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    CASE \n      WHEN waf_id = 'DG-01-03' AND EXISTS (\n        SELECT 1 FROM system.access.table_lineage LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-01-04' AND EXISTS (\n        SELECT 1 FROM system.information_schema.columns WHERE comment IS NOT NULL LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-01-05' AND EXISTS (\n        SELECT 1 FROM system.information_schema.table_tags LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-02-01' AND EXISTS (\n        SELECT 1 FROM system.information_schema.row_filters LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-02-02' AND EXISTS (\n        SELECT 1 FROM system.access.audit LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-02-03' AND EXISTS (\n        SELECT 1 FROM system.marketplace.listing_access_events LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-03-02' AND EXISTS (\n        SELECT 1 FROM system.information_schema.tables \n        WHERE table_name LIKE '%_drift_metrics' OR table_name LIKE '%_profile_metrics' \n        LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'DG-03-03' AND EXISTS (\n        SELECT 1 FROM system.information_schema.tables \n        WHERE table_type = 'BASE TABLE'\n        LIMIT 1\n      ) THEN 'Yes'\n      ELSE 'No'\n    END AS implemented\n  FROM (\n    SELECT * FROM VALUES\n      ('DG-01-03'), ('DG-01-04'), ('DG-01-05'),\n      ('DG-02-01'), ('DG-02-02'), ('DG-02-03'),\n      ('DG-03-02'), ('DG-03-03')\n    AS waf(waf_id)\n  )\n)\n\nSELECT\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status\n"},{"name":"c19487ca","displayName":"waf_controls_i","query":"SELECT\n  waf_id,\n  principle,\n  practice,\n  source_object,\n  CASE \n    WHEN waf_id = 'IU-01-01' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage_type = 'API_OPERATION' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-01-02' AND EXISTS (\n      SELECT 1 FROM system.information_schema.connections LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-01-03' AND EXISTS (\n      SELECT 1 FROM system.access.audit WHERE action_name LIKE '%PartnerConnection%' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-02-01' AND EXISTS (\n      SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-02-02' AND EXISTS (\n      SELECT 1 FROM system.access.audit WHERE action_name LIKE '%DeltaSharing%' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-02-03' AND EXISTS (\n      SELECT 1 --Currently in Private preview -- FROM system.mlflow.experiments_latest LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-03-01' AND EXISTS (\n      SELECT catalog_owner, COUNT(*) FROM system.information_schema.catalogs GROUP BY catalog_owner HAVING COUNT(*) > 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-03-02' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-03-03' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-03-04' AND EXISTS (\n      SELECT 1 FROM system.access.assistant_events LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'IU-04-03' AND EXISTS (\n      SELECT 1 FROM system.access.table_lineage LIMIT 1\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS implemented\nFROM (\n  SELECT * FROM VALUES\n    ('IU-01-01', 'Define standards for integration', 'Use standard and reusable integration patterns', 'system.billing.usage'),\n    ('IU-01-02', 'Define standards for integration', 'Use optimized connectors to ingest data sources', 'system.information_schema.connections'),\n    ('IU-01-03', 'Define standards for integration', 'Use certified partner tools', 'system.access.audit'),\n    ('IU-02-01', 'Utilize open interfaces and data formats', 'Use open data formats', 'system.information_schema.tables'),\n    ('IU-02-02', 'Utilize open interfaces and data formats', 'Enable secure data sharing', 'system.access.audit'),\n    ('IU-02-03', 'Utilize open interfaces and data formats', 'Use open standards for AI workflows', 'system.mlflow.experiments_latest'),\n    ('IU-03-01', 'Simplify new use case implementation', 'Provide a self-service experience', 'system.information_schema.catalogs'),\n    ('IU-03-02', 'Simplify new use case implementation', 'Use serverless services', 'system.billing.usage'),\n    ('IU-03-03', 'Simplify new use case implementation', 'Use pre-defined compute templates', 'system.compute.clusters'),\n    ('IU-03-04', 'Simplify new use case implementation', 'Use AI productivity tools', 'system.assistant.usage'),\n    ('IU-04-03', 'Ensure data consistency and usability', 'Provide central catalog for discovery and lineage', 'system.access.table_lineage')\n) waf(waf_id, principle, practice, source_object);\n"},{"name":"83c64453","displayName":"waf_principal_percentage_i","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    principle,\n    practice,\n    description,\n    CASE \n      WHEN waf_id = 'IU-01-01' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type = 'API_OPERATION' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-01-02' AND EXISTS (SELECT 1 FROM system.information_schema.connections LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-01-03' AND EXISTS (SELECT 1 FROM system.access.audit WHERE action_name LIKE '%PartnerConnection%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-01' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-02' AND EXISTS (SELECT 1 FROM system.access.audit WHERE action_name LIKE '%DeltaSharing%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-03' AND EXISTS (SELECT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-01' AND EXISTS (SELECT catalog_owner, COUNT(DISTINCT catalog_owner) FROM system.information_schema.catalogs GROUP BY catalog_owner HAVING COUNT(*) > 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-02' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-03' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-04' AND EXISTS (SELECT 1 FROM system.access.assistant_events LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-04-03' AND EXISTS (SELECT 1 FROM system.access.table_lineage LIMIT 1) THEN 'Yes'\n      ELSE 'No'\n    END AS implemented\n  FROM (\n    SELECT * FROM VALUES\n      ('IU-01-01', 'Define standards for integration', 'Use standard and reusable integration patterns', 'Tracks usage of REST API, SDKs, CLI for external integration'),\n      ('IU-01-02', 'Define standards for integration', 'Use optimized connectors to ingest data sources (Federation)', 'Monitors federated connectors to external sources'),\n      ('IU-01-03', 'Define standards for integration', 'Use certified partner tools', 'Captures Partner Connect actions from audit logs'),\n      ('IU-02-01', 'Utilize open interfaces and data formats', 'Use open data formats (Delta)', 'Verifies use of Delta tables'),\n      ('IU-02-02', 'Utilize open interfaces and data formats', 'Enable secure data sharing (Delta Sharing)', 'Detects Delta Sharing usage from audit events'),\n      ('IU-02-03', 'Utilize open interfaces and data formats', 'Use open standards for AI workflows (MLflow)', 'Checks MLflow experiments and runs in system tables'),\n      ('IU-03-01', 'Simplify new use case implementation', 'Provide a self-service experience across the platform', 'Indicates multi-catalog ownership for self-service structure'),\n      ('IU-03-02', 'Simplify new use case implementation', 'Use serverless services', 'Confirms serverless workloads in billing logs'),\n      ('IU-03-03', 'Simplify new use case implementation', 'Use pre-defined compute templates (Cluster Policies)', 'Validates cluster policy usage'),\n      ('IU-03-04', 'Simplify new use case implementation', 'Use AI productivity tools (Databricks Assistant)', 'Shows Assistant usage through interaction logs'),\n      ('IU-04-03', 'Ensure data consistency and usability', 'Provide central catalog for discovery and lineage', 'Validates presence of lineage and shared catalogs')\n    AS waf(waf_id, principle, practice, description)\n  )\n)\n\nSELECT\n  principle,\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status\nGROUP BY principle\nORDER BY principle"},{"name":"05c16819","displayName":"total_percentage_i","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    CASE \n      WHEN waf_id = 'IU-01-01' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type = 'API_OPERATION' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-01-02' AND EXISTS (SELECT 1 FROM system.information_schema.connections LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-01-03' AND EXISTS (SELECT 1 FROM system.access.audit WHERE action_name LIKE '%PartnerConnection%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-01' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-02' AND EXISTS (SELECT 1 FROM system.access.audit WHERE action_name LIKE '%DeltaSharing%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-03' AND EXISTS (SELECT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-01' AND EXISTS (SELECT catalog_owner, COUNT(DISTINCT catalog_owner) FROM system.information_schema.catalogs GROUP BY catalog_owner HAVING COUNT(*) > 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-02' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-03' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-04' AND EXISTS (SELECT 1 FROM system.access.assistant_events LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-04-03' AND EXISTS (SELECT 1 FROM system.access.table_lineage LIMIT 1) THEN 'Yes'\n      ELSE 'No'\n    END AS implemented\n  FROM (\n    SELECT * FROM VALUES\n      ('IU-01-01'), ('IU-01-02'), ('IU-01-03'),\n      ('IU-02-01'), ('IU-02-02'), ('IU-02-03'),\n      ('IU-03-01'), ('IU-03-02'), ('IU-03-03'), ('IU-03-04'),\n      ('IU-04-03')\n    AS waf(waf_id)\n  )\n)\n\nSELECT\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status;"},{"name":"b39d7f91","displayName":"total_percentage_across_pillars","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    CASE \n      WHEN waf_id = 'IU-01-01' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type = 'API_OPERATION' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-01-02' AND EXISTS (SELECT 1 FROM system.information_schema.connections LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-01-03' AND EXISTS (SELECT 1 FROM system.access.audit WHERE action_name LIKE '%PartnerConnection%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-01' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-02' AND EXISTS (SELECT 1 FROM system.access.audit WHERE action_name LIKE '%DeltaSharing%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-03' AND EXISTS (SELECT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-01' AND EXISTS (SELECT catalog_owner, COUNT(DISTINCT catalog_owner) FROM system.information_schema.catalogs GROUP BY catalog_owner HAVING COUNT(*) > 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-02' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-03' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-04' AND EXISTS (SELECT 1 FROM system.access.assistant_events LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-04-03' AND EXISTS (SELECT 1 FROM system.access.table_lineage LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-01-03' AND EXISTS (SELECT 1 FROM system.access.table_lineage LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-01-04' AND EXISTS (SELECT 1 FROM system.information_schema.columns WHERE comment IS NOT NULL LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-01-05' AND EXISTS (SELECT 1 FROM system.information_schema.table_tags LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-02-01' AND EXISTS (SELECT 1 FROM system.information_schema.row_filters LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-02-02' AND EXISTS (SELECT 1 FROM system.access.audit LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-02-03' AND EXISTS (SELECT 1 FROM system.marketplace.listing_access_events LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-03-02' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE table_name LIKE '%_drift_metrics' OR table_name LIKE '%_profile_metrics' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-03-03' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE table_type = 'BASE TABLE' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-01-01' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-01-03' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SQL%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-01-04' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE dbr_version IS NOT NULL LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-01-06' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-01-09' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE product_features.is_photon = true LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-02-03' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-03-01' AND EXISTS (SELECT 1 FROM system.billing.usage LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-03-02' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE size(map_keys(tags)) > 0 LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'CO-03-03' AND EXISTS (SELECT 1 FROM system.billing.usage LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'PE-01-01' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage.sku_name LIKE '%JOBS_SERVERLESS_COMPUTE%' OR usage.sku_name LIKE '%SERVERLESS_SQL%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'PE-01-02' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage.sku_name LIKE '%SERVERLESS_REAL_TIME_INFERENCE%' LIMIT 1 ) THEN 'Yes'\n      WHEN waf_id = 'PE-02-02' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE worker_count > 1 LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'PE-02-04' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE worker_count > 3 LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'PE-02-05' AND NOT EXISTS (SELECT 1 FROM system.information_schema.routines WHERE external_language = 'Python' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'PE-02-06' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE billing_origin_product IN ('ALL_PURPOSE','JOBS','DLT') AND product_features.is_photon = true LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'PE-02-07' AND EXISTS (SELECT 1 FROM system.compute.clusters HAVING COUNT(DISTINCT split(worker_node_type,'[.]')[0])/COUNT(1) >= 0.05) THEN 'Yes'\n      ELSE 'No'\n    END AS implemented,\n    CASE \n      WHEN waf_id LIKE 'IU-%' THEN 'Interoperability & Usability'\n      WHEN waf_id LIKE 'DG-%' THEN 'Data & AI Governance'\n      WHEN waf_id LIKE 'CO-%' THEN 'Cost Optimization'\n      WHEN waf_id LIKE 'PE-%' THEN 'Performance Efficiency'\n    END AS pillar\n  FROM (\n    SELECT * FROM VALUES\n      ('IU-01-01'), ('IU-01-02'), ('IU-01-03'),\n      ('IU-02-01'), ('IU-02-02'), ('IU-02-03'),\n      ('IU-03-01'), ('IU-03-02'), ('IU-03-03'), ('IU-03-04'),\n      ('IU-04-03'),\n      ('DG-01-03'), ('DG-01-04'), ('DG-01-05'),\n      ('DG-02-01'), ('DG-02-02'), ('DG-02-03'),\n      ('DG-03-02'), ('DG-03-03'),\n      ('CO-01-01'), ('CO-01-03'), ('CO-01-04'), ('CO-01-06'), ('CO-01-09'),\n      ('CO-02-03'), ('CO-03-01'), ('CO-03-02'), ('CO-03-03'),\n      ('PE-01-01'),('PE-01-02'),\n      ('PE-02-02'),('PE-02-04'),('PE-02-05'),('PE-02-06'),('PE-02-07')\n    AS waf(waf_id)\n  )\n)\n\nSELECT\n  pillar,\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status\nGROUP BY pillar;\n"},{"name":"dbdc9433","displayName":"waf_controls_c","query":"SELECT\n  waf_id,\n  principle,\n  best_practice,\n  CASE \n    WHEN waf_id = 'CO-01-01' AND EXISTS (\n      SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1\n    ) THEN 'Yes'\n    -- WHEN waf_id = 'CO-01-02' AND EXISTS (\n    --   SELECT 1 FROM system.lakeflow.job_task_run_timeline JOIN system.compute.clusters USING (cluster_id)\n    --   WHERE is_interactive = false LIMIT 1\n    -- ) THEN 'Yes'\n    WHEN waf_id = 'CO-01-03' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SQL%' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'CO-01-04' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE dbr_version IS NOT NULL LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'CO-01-06' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'CO-01-09' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE product_features.is_photon = true LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'CO-02-03' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'CO-03-01' AND EXISTS (\n      SELECT 1 FROM system.billing.usage LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'CO-03-02' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE size(map_keys(tags)) > 0 LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'CO-03-03' AND EXISTS (\n      SELECT 1 FROM system.billing.usage LIMIT 1\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS implemented\nFROM (\n  SELECT * FROM VALUES\n    ('CO-01-01', 'Choose optimal resources', 'Use performance optimized data formats'),\n    --('CO-01-02', 'Choose optimal resources', 'Use job clusters'),\n    ('CO-01-03', 'Choose optimal resources', 'Use SQL warehouse for SQL workloads'),\n    ('CO-01-04', 'Choose optimal resources', 'Use up-to-date runtimes'),\n    ('CO-01-06', 'Choose optimal resources', 'Use Serverless for your workloads'),\n    ('CO-01-09', 'Choose optimal resources', 'Evaluate performance optimized query engines'),\n    ('CO-02-03', 'Dynamically allocate resources', 'Use compute policies to control costs'),\n    ('CO-03-01', 'Monitor and control cost', 'Monitor costs'),\n    ('CO-03-02', 'Monitor and control cost', 'Tag clusters for cost attribution'),\n    ('CO-03-03', 'Monitor and control cost', 'Implement observability to track & chargeback cost')\n) waf(waf_id, principle, best_practice);\n"},{"name":"81f0a6aa","displayName":"waf_principal_percentage_c","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    principle,\n    CASE \n      WHEN waf_id = 'CO-01-01' AND EXISTS (\n        SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1\n      ) THEN 'Yes'\n      -- WHEN waf_id = 'CO-01-02' AND EXISTS (\n      --   SELECT 1 FROM system.lakeflow.job_task_run_timeline JOIN system.compute.clusters USING (cluster_id)\n      --   WHERE is_interactive = false LIMIT 1\n      -- ) THEN 'Yes'\n      WHEN waf_id = 'CO-01-03' AND EXISTS (\n        SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SQL%' LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-01-04' AND EXISTS (\n        SELECT 1 FROM system.compute.clusters WHERE dbr_version IS NOT NULL LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-01-06' AND EXISTS (\n        SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-01-09' AND EXISTS (\n        SELECT 1 FROM system.billing.usage WHERE product_features.is_photon = true LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-02-03' AND EXISTS (\n        SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-03-01' AND EXISTS (\n        SELECT 1 FROM system.billing.usage LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-03-02' AND EXISTS (\n        SELECT 1 FROM system.compute.clusters WHERE size(map_keys(tags)) > 0 LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-03-03' AND EXISTS (\n        SELECT 1 FROM system.billing.usage LIMIT 1\n      ) THEN 'Yes'\n      ELSE 'No'\n    END AS implemented\n  FROM (\n    SELECT * FROM VALUES\n      ('CO-01-01', 'Choose optimal resources'),\n      --('CO-01-02', 'Choose optimal resources'),\n      ('CO-01-03', 'Choose optimal resources'),\n      ('CO-01-04', 'Choose optimal resources'),\n      ('CO-01-06', 'Choose optimal resources'),\n      ('CO-01-09', 'Choose optimal resources'),\n      ('CO-02-03', 'Dynamically allocate resources'),\n      ('CO-03-01', 'Monitor and control cost'),\n      ('CO-03-02', 'Monitor and control cost'),\n      ('CO-03-03', 'Monitor and control cost')\n    AS waf(waf_id, principle)\n  )\n)\n\nSELECT\n  principle,\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status\nGROUP BY principle\nORDER BY principle;\n"},{"name":"06f2987c","displayName":"total_percentage_c","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    CASE \n      WHEN waf_id = 'CO-01-01' AND EXISTS (\n        SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1\n      ) THEN 'Yes'\n      -- WHEN waf_id = 'CO-01-02' AND EXISTS (\n      --   SELECT 1 FROM system.lakeflow.job_task_run_timeline JOIN system.compute.clusters USING (cluster_id)\n      --   WHERE is_interactive = false LIMIT 1\n      -- ) THEN 'Yes'\n      WHEN waf_id = 'CO-01-03' AND EXISTS (\n        SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SQL%' LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-01-04' AND EXISTS (\n        SELECT 1 FROM system.compute.clusters WHERE dbr_version IS NOT NULL LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-01-06' AND EXISTS (\n        SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-01-09' AND EXISTS (\n        SELECT 1 FROM system.billing.usage WHERE product_features.is_photon = true LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-02-03' AND EXISTS (\n        SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-03-01' AND EXISTS (\n        SELECT 1 FROM system.billing.usage LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-03-02' AND EXISTS (\n        SELECT 1 FROM system.compute.clusters WHERE size(map_keys(tags)) > 0 LIMIT 1\n      ) THEN 'Yes'\n      WHEN waf_id = 'CO-03-03' AND EXISTS (\n        SELECT 1 FROM system.billing.usage LIMIT 1\n      ) THEN 'Yes'\n      ELSE 'No'\n    END AS implemented\n  FROM (\n    SELECT * FROM VALUES\n      ('CO-01-01'),\n      --('CO-01-02'),\n      ('CO-01-03'),\n      ('CO-01-04'),\n      ('CO-01-06'),\n      ('CO-01-09'),\n      ('CO-02-03'),\n      ('CO-03-01'),\n      ('CO-03-02'),\n      ('CO-03-03')\n    AS waf(waf_id)\n  )\n)\n\nSELECT\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status;\n"},{"name":"2aa3d48a","displayName":"total_percentage_across_pillars 1","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    CASE \n      WHEN waf_id = 'IU-01-01' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type = 'API_OPERATION' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-01-02' AND EXISTS (SELECT 1 FROM system.information_schema.connections LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-01-03' AND EXISTS (SELECT 1 FROM system.access.audit WHERE action_name LIKE '%PartnerConnection%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-01' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE data_source_format = 'DELTA' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-02' AND EXISTS (SELECT 1 FROM system.access.audit WHERE action_name LIKE '%DeltaSharing%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-02-03' AND EXISTS (SELECT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-01' AND EXISTS (SELECT catalog_owner, COUNT(DISTINCT catalog_owner) FROM system.information_schema.catalogs GROUP BY catalog_owner HAVING COUNT(*) > 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-02' AND EXISTS (SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SERVERLESS%' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-03' AND EXISTS (SELECT 1 FROM system.compute.clusters WHERE policy_id IS NOT NULL LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-03-04' AND EXISTS (SELECT 1 FROM system.access.assistant_events LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'IU-04-03' AND EXISTS (SELECT 1 FROM system.access.table_lineage LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-01-03' AND EXISTS (SELECT 1 FROM system.access.table_lineage LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-01-04' AND EXISTS (SELECT 1 FROM system.information_schema.columns WHERE comment IS NOT NULL LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-01-05' AND EXISTS (SELECT 1 FROM system.information_schema.table_tags LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-02-01' AND EXISTS (SELECT 1 FROM system.information_schema.row_filters LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-02-02' AND EXISTS (SELECT 1 FROM system.access.audit LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-02-03' AND EXISTS (SELECT 1 FROM system.marketplace.listing_access_events LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-03-02' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE table_name LIKE '%_drift_metrics' OR table_name LIKE '%_profile_metrics' LIMIT 1) THEN 'Yes'\n      WHEN waf_id = 'DG-03-03' AND EXISTS (SELECT 1 FROM system.information_schema.tables WHERE table_type = 'BASE TABLE' LIMIT 1) THEN 'Yes'\n      ELSE 'No'\n    END AS implemented,\n    CASE \n      WHEN waf_id LIKE 'IU-%' THEN 'Interoperability & Usability'\n      WHEN waf_id LIKE 'DG-%' THEN 'Data & AI Governance'\n    END AS pillar\n  FROM (\n    SELECT * FROM VALUES\n      ('IU-01-01'), ('IU-01-02'), ('IU-01-03'),\n      ('IU-02-01'), ('IU-02-02'), ('IU-02-03'),\n      ('IU-03-01'), ('IU-03-02'), ('IU-03-03'), ('IU-03-04'),\n      ('IU-04-03'),\n      ('DG-01-03'), ('DG-01-04'), ('DG-01-05'),\n      ('DG-02-01'), ('DG-02-02'), ('DG-02-03'),\n      ('DG-03-02'), ('DG-03-03')\n    AS waf(waf_id)\n  )\n)\n\nSELECT\n  pillar,\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status\nGROUP BY pillar;"},{"name":"4745a0f9","displayName":"waf_controls_p","query":"SELECT\n  waf_id,\n  principle,\n  best_practice,\n  CASE \n    WHEN waf_id = 'PE-01-01' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage.sku_name LIKE '%JOBS_SERVERLESS_COMPUTE%' OR usage.sku_name LIKE '%SERVERLESS_SQL%' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-01-02' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage.sku_name LIKE '%SERVERLESS_REAL_TIME_INFERENCE%' LIMIT 1 \n    ) THEN 'Yes'\n--    WHEN waf_id = 'PE-02-01' AND EXISTS (\n--      SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SQL%' LIMIT 1\n--    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-02' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE worker_count > 1 LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-04' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE worker_count > 3 LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-05' AND NOT EXISTS (\n      SELECT 1 FROM system.information_schema.routines WHERE external_language = 'Python' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-06' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE billing_origin_product IN ('ALL_PURPOSE','JOBS','DLT') AND product_features.is_photon = true LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-07' AND EXISTS (\n       SELECT 1 FROM system.compute.clusters HAVING COUNT(DISTINCT split(worker_node_type,'[.]')[0])/COUNT(1) >= 0.05 --Look for at least 5% variety in instance families\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS implemented\nFROM (\n  SELECT * FROM VALUES\n    ('PE-01-01', 'Utilize serverless capabilities', 'Use serverless architecture'),\n    ('PE-01-02', 'Utilize serverless capabilities', 'Use an enterprise grade model serving service'),\n    --('PE-02-01', 'Utilize serverless capabilities', 'Understand your data ingestion and access patterns'),\n    ('PE-02-02', 'Design workloads for performance', 'Use parallel computation where it is beneficial'),\n    --('PE-02-03', 'Design workloads for performance', 'Analyze the whole chain of execution'),\n    ('PE-02-04', 'Design workloads for performance', 'Prefer larger clusters'),\n    ('PE-02-05', 'Design workloads for performance', 'Use native Spark operations'),\n    ('PE-02-06', 'Design workloads for performance', 'Use native platform engines'),\n    ('PE-02-07', 'Design workloads for performance', 'Understand your hardware and workload type')\n    --('PE-02-08', 'Design workloads for performance', 'Use caching'),\n    --('PE-02-09', 'Design workloads for performance', 'Use compaction'),\n) waf(waf_id, principle, best_practice);\n"},{"name":"13e29e6c","displayName":"waf_principal_percentage_p","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    principle,\n    CASE \n    WHEN waf_id = 'PE-01-01' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage.sku_name LIKE '%JOBS_SERVERLESS_COMPUTE%' OR usage.sku_name LIKE '%SERVERLESS_SQL%' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-01-02' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage.sku_name LIKE '%SERVERLESS_REAL_TIME_INFERENCE%' LIMIT 1 \n    ) THEN 'Yes'\n--    WHEN waf_id = 'PE-02-01' AND EXISTS (\n--      SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SQL%' LIMIT 1\n--    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-02' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE worker_count > 1 LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-04' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE worker_count > 3 LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-05' AND NOT EXISTS (\n      SELECT 1 FROM system.information_schema.routines WHERE external_language = 'Python' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-06' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE billing_origin_product IN ('ALL_PURPOSE','JOBS','DLT') AND product_features.is_photon = true LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-07' AND EXISTS (\n       SELECT 1 FROM system.compute.clusters HAVING COUNT(DISTINCT split(worker_node_type,'[.]')[0])/COUNT(1) >= 0.05 --Look for at least 5% variety in instance families\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS implemented\n  FROM (\n    SELECT * FROM VALUES\n      ('PE-01-01', 'Utilize serverless capabilities'),\n    ('PE-01-02', 'Utilize serverless capabilities'),\n    --('PE-02-01', 'Utilize serverless capabilities'),\n    ('PE-02-02', 'Design workloads for performance'),\n    --('PE-02-03', 'Design workloads for performance'),\n    ('PE-02-04', 'Design workloads for performance'),\n    ('PE-02-05', 'Design workloads for performance'),\n    ('PE-02-06', 'Design workloads for performance'),\n    ('PE-02-07', 'Design workloads for performance')\n    --('PE-02-08', 'Design workloads for performance'),\n    --('PE-02-09', 'Design workloads for performance'),\n    AS waf(waf_id, principle)\n  )\n)\n\nSELECT\n  principle,\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status\nGROUP BY principle\nORDER BY principle;\n"},{"name":"87deca0d","displayName":"total_percentage_p","query":"WITH waf_status AS (\n  SELECT\n    waf_id,\n    CASE \n    WHEN waf_id = 'PE-01-01' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage.sku_name LIKE '%JOBS_SERVERLESS_COMPUTE%' OR usage.sku_name LIKE '%SERVERLESS_SQL%' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-01-02' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE usage.sku_name LIKE '%SERVERLESS_REAL_TIME_INFERENCE%' LIMIT 1 \n    ) THEN 'Yes'\n--    WHEN waf_id = 'PE-02-01' AND EXISTS (\n--      SELECT 1 FROM system.billing.usage WHERE usage_type LIKE '%SQL%' LIMIT 1\n--    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-02' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE worker_count > 1 LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-04' AND EXISTS (\n      SELECT 1 FROM system.compute.clusters WHERE worker_count > 3 LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-05' AND NOT EXISTS (\n      SELECT 1 FROM system.information_schema.routines WHERE external_language = 'Python' LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-06' AND EXISTS (\n      SELECT 1 FROM system.billing.usage WHERE billing_origin_product IN ('ALL_PURPOSE','JOBS','DLT') AND product_features.is_photon = true LIMIT 1\n    ) THEN 'Yes'\n    WHEN waf_id = 'PE-02-07' AND EXISTS (\n       SELECT 1 FROM system.compute.clusters HAVING COUNT(DISTINCT split(worker_node_type,'[.]')[0])/COUNT(1) >= 0.05 --Look for at least 5% variety in instance families\n    ) THEN 'Yes'\n    ELSE 'No'\n  END AS implemented\n  FROM (\n    SELECT * FROM VALUES\n    ('PE-01-01'),\n    ('PE-01-02'),\n    --('PE-02-01'),\n    ('PE-02-02'),\n    --('PE-02-03'),\n    ('PE-02-04'),\n    ('PE-02-05'),\n    ('PE-02-06'),\n    ('PE-02-07')\n    --('PE-02-08'),\n    --('PE-02-09'),\n    AS waf(waf_id)\n  )\n)\n\nSELECT\n  COUNT(*) AS total_controls,\n  SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) AS implemented_controls,\n  ROUND(100 * SUM(CASE WHEN implemented = 'Yes' THEN 1 ELSE 0 END) / COUNT(*), 0) AS completion_percent\nFROM waf_status;\n"},{"name":"a5da7a83","displayName":"waf_CO-01-01_table_formats","query":"SELECT \n    --table_catalog AS cat_name,\n    --table_schema AS sch_name,\n    data_source_format AS tables_format,\n    count(data_source_format) AS no_of_tables\n    --table_type\n    FROM system.information_schema.tables group by all order by no_of_tables desc;"},{"name":"c436a496","displayName":"waf_CO-01-01_managed_tables","query":"SELECT \n    table_type,\n    round(count(table_type)/(select count(*) from system.information_schema.tables) * 100) as percent_of_tables\n    FROM system.information_schema.tables\n    group by ALL\n    having percent_of_tables > 0\n    order by percent_of_tables desc"},{"name":"feca6b37","displayName":"waf_CO-01-02_jobs_on_all_purpose","query":"with clusters AS (\n  SELECT\n    *,\n    ROW_NUMBER() OVER(PARTITION BY workspace_id, cluster_id ORDER BY change_time DESC) as rn\n  FROM system.compute.clusters\n  WHERE cluster_source=\"UI\" OR cluster_source=\"API\"\n  QUALIFY rn=1\n),\njob_tasks_exploded AS (\n  SELECT\n    workspace_id,\n    job_id,\n    EXPLODE(compute_ids) as cluster_id\n  FROM system.lakeflow.job_task_run_timeline\n  WHERE period_start_time >= CURRENT_DATE() - INTERVAL 30 DAY\n  GROUP BY ALL\n),\nall_purpose_cluster_jobs AS (\n  SELECT\n    t1.*,\n    t2.cluster_name,\n    t2.owned_by,\n    t2.dbr_version\n  FROM job_tasks_exploded t1\n    INNER JOIN clusters t2 USING (workspace_id, cluster_id)\n)\nSELECT * FROM all_purpose_cluster_jobs LIMIT 10;"},{"name":"d654eb5a","displayName":"waf_CO-01-03_sql_vs_allpurpose","query":"-- ToDo: Use $DBUs with account_prices system table when it is available\n-- show SKU distribution between All-Purpose and SQL Warehouses, companies with primary DWH are expected even over 50 % of $DBUs on DWH\n-- docs: https://docs.databricks.com/aws/en/admin/system-tables/billing#billing-origin-product-reference\nselect billing_origin_product, sum(usage_quantity) as dbu from system.billing.usage where billing_origin_product in ('SQL','ALL_PURPOSE') and usage_date >= current_date() - interval 30 days \ngroup by billing_origin_product;"},{"name":"898f3132","displayName":"waf_CO-01-03_sql_on_allpurpose","query":"-- ToDo\n-- show SKU distribution between All-Purpose and SQL Warehouses, companies with primary DWH are expected even over 50 % on DWH\n-- ToDo: What query? Check utilization metrics? Or track Academy?\nselect 'Coming Soon...'  as message;\n-- select * from system.billing.usage where billing_origin_product in ('ALL_PURPOSE','SQL');\n-- optional Verbose logging shows command text, this can extract/guess the language https://docs.databricks.com/aws/en/admin/account-settings/verbose-logs\n-- workloadTags=commandLanguage or notebookLanguage=sql and SKU All-Purpose"},{"name":"f4e7201f","displayName":"waf_CO-01-04_latest_dbr","query":"-- ToDo: Add filter on L28d eg  WHERE period_start_time >= CURRENT_DATE() - INTERVAL 30 DAY\nselect regexp_extract(dbr_version, '^(\\\\d+\\\\.\\\\d+)',1) as version, count(*) as count\nfrom system.compute.clusters \nwhere not contains(dbr_version, 'custom') \n  and cluster_source not in('PIPELINE','PIPELINE_MAINTENANCE') \n  and delete_time is null\ngroup by 1\norder by count desc;"},{"name":"62126ae8","displayName":"waf_CO-01-05_gpu","query":"-- ToDo: List all VM instances with GPUs across clouds and check their usage in system tables. How to keep it up to date?\n-- https://docs.databricks.com/aws/en/compute/gpu\n-- SRTI Mockup for now:\n--select * as DBUs from system.billing.usage u where contains(u.sku_name, 'SERVERLESS_REAL_TIME_INFERENCE') and date_diff(day, u.usage_start_time, now()) <28;\n-- ToDo: What query? Check utilization metrics? Or track Academy?\nselect 'Coming Soon...' as message;\n"},{"name":"a36b2899","displayName":"waf_CO-01-06_serverless","query":"with serverless as (\n    select sum(usage_quantity) as dbu from system.billing.usage u where contains(u.sku_name, 'SERVERLESS') and u.billing_origin_product in ('ALL_PURPOSE','SQL','JOBS', 'DLT','INTERACTIVE') and date_diff(day, u.usage_start_time, now()) <28\n),\ntotal as (\n    select sum(usage_quantity) as dbu from system.billing.usage u where  u.billing_origin_product in ('ALL_PURPOSE','SQL','JOBS', 'DLT','INTERACTIVE') and date_diff(day, u.usage_start_time, now()) <28\n)\nselect serverless.dbu * 100 / total.dbu as serverless_dbu_percent from serverless cross join total;\n"},{"name":"aed75aae","displayName":"waf_CO-01-06_serverless_sql","query":"--ToDo: Use account_prices system table when available\nselect \n--t1.usage_date,\ncase when t1.sku_name like '%SERVERLESS_SQL%' then 'SQL_SERVERLESS' \nwhen t1.sku_name like '%ENTERPRISE_SQL_COMPUTE%' then 'SQL_CLASSIC'\nwhen t1.sku_name like '%SQL_PRO%' then 'SQL_PRO'\nelse 'Other' end as sql_sku_name,\nSUM(t1.usage_quantity * list_prices.pricing.default) as list_cost\nFROM system.billing.usage t1\nINNER JOIN system.billing.list_prices on\n   t1.cloud = list_prices.cloud and\n   t1.sku_name = list_prices.sku_name and\n   t1.usage_start_time >= list_prices.price_start_time and\n   (t1.usage_end_time <= list_prices.price_end_time or list_prices.price_end_time is null)\nwhere t1.sku_name like '%SQL%' and t1.usage_date >= current_date() - interval 30 days\ngroup by all"},{"name":"efb892e1","displayName":"waf_CO-01-07_instance_type","query":"-- ToDo: What query? Check utilization metrics? Or track Academy?\n-- Instance type: Compute-optimized, Memory-optimized etc?\nselect 'Coming Soon...'  as message;"},{"name":"1de7073d","displayName":"waf_CO-01-08_cluster_size","query":"-- ToDo: What query? Check utilization metrics? Or track Academy?\n-- Use CASE statement and bucket into Personal cluster / Small / Medium / Large\n-- --ToDo: Show also % of Single VM vs multi? Eg in cluster sizes with tags.ResourceClass='SingleNode'\nselect 'Coming Soon...'  as message;"},{"name":"31958c67","displayName":"waf_CO-01-08_cluster_utilization","query":"-- based on: https://community.databricks.com/t5/data-engineering/cpu-usage-and-idle-time-metrics-from-system-tables/td-p/116314\nWITH per_cluster_daily AS (\n  SELECT\n    cluster_id,\n    DATE_TRUNC('DAY', start_time) AS day,\n    AVG(cpu_user_percent + cpu_system_percent) AS avg_cpu_usage_percent, -- Average CPU usage as the sum of user and system CPU\n    --100 - AVG(cpu_user_percent + cpu_system_percent) AS avg_cpu_idle_percent,                      -- Average CPU idle time percentage\n    AVG(mem_used_percent) AS avg_memory_usage_percent                   -- Average memory usage percentage\n  FROM\n    system.compute.node_timeline\n  WHERE\n    start_time >= CURRENT_DATE - INTERVAL 28 DAYS -- Limit data to the last 30 days (optional)\n  GROUP BY\n    cluster_id,\n    DATE_TRUNC('DAY', start_time)\n)\nSELECT\n  percentile(avg_cpu_usage_percent, 0.75) as cpu_usage_percent_p75,\n  percentile(avg_memory_usage_percent, 0.75) as memory_usage_percent_p75\nFROM\n  per_cluster_daily\n  group by all;"},{"name":"951a00c5","displayName":"waf_CO-01-09_photon","query":"select 'Coming Soon...'  as message;\n"},{"name":"b54341e5","displayName":"waf_CO-02-01_auto_scaling","query":"with autoscaling_count as (select count(*) as autoscaling_count from system.compute.clusters where max_autoscale_workers is not null and delete_time is null),\ntotal_clusters_count as (select count(*) as total_clusters_count from system.compute.clusters where delete_time is null)\nselect autoscaling_count.autoscaling_count * 100 / total_clusters_count.total_clusters_count as autoscaling_percent from total_clusters_count cross join autoscaling_count;"},{"name":"d0192813","displayName":"waf_CO-02-02_auto_termination","query":"-- UI and API are All Purpose classic clusters.\nselect percentile(c.auto_termination_minutes, 0.75) as p_75_auto_termination_minutes, max(c.auto_termination_minutes) as max_auto_termination_minutes, count_if(c.auto_termination_minutes is null) as count_clusters_without_autoterminations, count_if(c.auto_termination_minutes is not null) as count_clusters_with_autoterminations, (count_clusters_without_autoterminations*100)/count(*) as percent_clusters_without_autoterminations from system.compute.clusters c where c.cluster_source in ('UI','API'/*Only UI and API are All Purpose classic clusters,'JOB'*/) and c.delete_time is null;\n"},{"name":"cc24226f","displayName":"waf_CO-02-03_cluster_policies","query":"select 'Coming Soon...'  as message;"},{"name":"e46a4a40","displayName":"waf_CO-03-01_billing_tables","query":"-- How often is system.billing.usage accessed L28d? Eg 19k in field-eng L30d\nselect\n  event_date,\n  count(*) as usage_read\nfrom\n  system.access.audit\nwhere\n  service_name = 'unityCatalog'\n  and action_name = 'getTable'\n  and request_params.full_name_arg = 'system.billing.usage'\n  and user_identity.email != 'System-User'\n  and (date_diff(day, event_date, current_date()) <= 90)\ngroup by event_date\norder by event_date;"},{"name":"bb77bb31","displayName":"waf_CO-03-02_tagging_compute","query":"-- Enhancement: use CASE statement and segment by number of tags\nselect array_size(map_entries(tags)) as number_of_tags, count(*) as count \nfrom system.compute.clusters \nwhere tags.ResourceClass is null \nand delete_time is null\ngroup by number_of_tags\norder by count desc, number_of_tags desc;"},{"name":"7abec3c3","displayName":"waf_CO-03-02_popular_tags","query":"with tag_counts as (\n  select\n    explode(map_keys(tags)) as tag,\n    count(*) as count\n  from\n    system.compute.clusters\n  group by\n    1\n),\ncluster_count as (select count(*) as count from system.compute.clusters)\nselect\n  tag_counts.tag,\n  sum(tag_counts.count) / any_value(cluster_count.count) *100 as percent\nfrom\n  tag_counts cross join cluster_count\ngroup by\n  tag_counts.tag\norder by\n  percent desc;"},{"name":"9f038f29","displayName":"waf_CO-03-03_chargeback","query":"select 'Coming Soon...'  as message;"},{"name":"e3cd19cf","displayName":"waf_CO-03-04_share_cost","query":"select 'Coming Soon...'  as message;"},{"name":"d83ae5eb","displayName":"waf_CO-03-05_data_transfer_cost","query":"select 'Coming Soon...'  as message;"},{"name":"d0a01e50","displayName":"waf_CO-04-01_streaming_triggers","query":"select 'Coming Soon...'  as message;"},{"name":"67073248","displayName":"waf_CO-04-02_spot_and_cost_optimized","query":"select 'Coming Soon...'  as message;"}],"pages":[{"name":"3f38204d","displayName":"Summary","layout":[{"widget":{"name":"2ca8f2ea","queries":[{"name":"main_query","query":{"datasetName":"b39d7f91","fields":[{"name":"sum(completion_percent)","expression":"SUM(`completion_percent`)"},{"name":"pillar","expression":"`pillar`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(completion_percent)","scale":{"type":"quantitative"},"displayName":"Sum of completion_percent"},"y":{"fieldName":"pillar","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"pillar"}},"frame":{"title":"Completion percentage across pillars","showTitle":true}}},"position":{"x":0,"y":0,"width":6,"height":6}},{"widget":{"name":"5c1053c3","textbox_spec":"WAF Coverage\n"},"position":{"x":0,"y":0,"width":6,"height":2}}],"pageType":"PAGE_TYPE_CANVAS"},{"name":"e9e15078","displayName":"Data And AI Governance","layout":[{"widget":{"name":"ec3a56bc","textbox_spec":"# Data And AI Governance"},"position":{"x":0,"y":0,"width":6,"height":2}},{"widget":{"name":"d682affb","queries":[{"name":"main_query","query":{"datasetName":"303a6758","fields":[{"name":"count(1)","expression":"`count(1)`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"count(1)","style":{"rules":[{"condition":{"operator":"=","operand":{"type":"data-value","value":"0"}},"color":"#888888"}]},"displayName":"count(1)"}},"frame":{"showTitle":true,"showDescription":false,"title":"Total Tables"}}},"position":{"x":0,"y":21,"width":2,"height":3}},{"widget":{"name":"f0321af0","queries":[{"name":"main_query","query":{"datasetName":"f5bf425c","fields":[{"name":"count(1)","expression":"`count(1)`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"count(1)","style":{"rules":[{"condition":{"operator":"=","operand":{"type":"data-value","value":"0"}},"color":"#888888"}]},"displayName":"count(1)"}},"frame":{"showTitle":true,"title":"Total Volumes","contentAlignment":"center"}}},"position":{"x":2,"y":21,"width":2,"height":3}},{"widget":{"name":"ee5b3bb1","queries":[{"name":"main_query","query":{"datasetName":"5fdcd556","fields":[{"name":"count(1)","expression":"`count(1)`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"count(1)","style":{"rules":[{"condition":{"operator":"=","operand":{"type":"data-value","value":"0"}},"color":"#888888"}]},"displayName":"count(1)"}},"frame":{"showTitle":true,"title":"Total Functions"}}},"position":{"x":4,"y":21,"width":2,"height":3}},{"widget":{"name":"33abd742","queries":[{"name":"main_query","query":{"datasetName":"a92ace17","fields":[{"name":"full_name_count","expression":"`full_name_count`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"full_name_count","displayName":"full_name_count"}},"frame":{"showTitle":true,"showDescription":true,"description":"See the count of tables with no reads","title":"Unused Tables (Last 30 Days)"}}},"position":{"x":0,"y":31,"width":2,"height":3}},{"widget":{"name":"bb0b2fd5","queries":[{"name":"main_query","query":{"datasetName":"55e66413","fields":[{"name":"distinct_tables","expression":"`distinct_tables`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"distinct_tables","style":{"rules":[{"condition":{"operator":"=","operand":{"type":"data-value","value":"0"}},"color":"#888888"}]},"displayName":"distinct_tables"}},"frame":{"showTitle":true,"title":"Active Tables (Last 30 days)","showDescription":true,"description":"See the count of tables with reads"}}},"position":{"x":2,"y":31,"width":2,"height":3}},{"widget":{"name":"7414554c","queries":[{"name":"main_query","query":{"datasetName":"90d7e6f1","fields":[{"name":"distinct_users","expression":"`distinct_users`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"distinct_users","style":{"rules":[{"condition":{"operator":"=","operand":{"type":"data-value","value":"0"}},"color":"#000000"}]},"displayName":"distinct_users"}},"frame":{"showTitle":true,"title":"Active Users (Last 30 Days)","showDescription":true,"description":"See the count of users who read from tables"}}},"position":{"x":4,"y":31,"width":2,"height":3}},{"widget":{"name":"bdaa8aa0","queries":[{"name":"main_query","query":{"datasetName":"628c2773","fields":[{"name":"full_name_count","expression":"`full_name_count`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"full_name_count","displayName":"full_name_count"}},"frame":{"showTitle":true,"title":"Ungoverned Tables","showDescription":true,"description":"See the count of tables to which all users have read access"}}},"position":{"x":0,"y":41,"width":3,"height":3}},{"widget":{"name":"e60dfd50","queries":[{"name":"main_query","query":{"datasetName":"1f951287","fields":[{"name":"distinct_table_count","expression":"`distinct_table_count`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"distinct_table_count","displayName":"distinct_table_count"}},"frame":{"showTitle":true,"title":"Sensitive Tables","showDescription":true,"description":"See the count of tables with either row filters or column masks"}}},"position":{"x":3,"y":41,"width":3,"height":3}},{"widget":{"name":"75d01e2b","queries":[{"name":"main_query","query":{"datasetName":"913b3827","fields":[{"name":"sum(count)","expression":"SUM(`count`)"},{"name":"label","expression":"`label`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"pie","encodings":{"angle":{"fieldName":"sum(count)","scale":{"type":"quantitative"},"displayName":" "},"color":{"fieldName":"label","scale":{"type":"categorical","mappings":[{"value":"Untagged","color":"#919191"},{"value":"Tagged","color":"#00A972"}]},"displayName":"Legend"},"label":{"show":true}},"frame":{"showTitle":true,"title":"Table Tag Usage","showDescription":false,"description":"See the breakdown of tagged and untagged tables"}}},"position":{"x":0,"y":44,"width":2,"height":6}},{"widget":{"name":"ff45bac8","queries":[{"name":"main_query","query":{"datasetName":"788914b8","fields":[{"name":"sum(usage_count)","expression":"SUM(`usage_count`)"},{"name":"tag_name","expression":"`tag_name`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(usage_count)","scale":{"type":"quantitative"},"displayName":"Usage Count"},"y":{"fieldName":"tag_name","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"Tag Name"},"label":{"show":false}},"frame":{"showTitle":true,"title":"Most Popular Table Tags","showDescription":false,"description":""},"mark":{"colors":["#AB4057","#FFAB00","#00A972","#FF3621","#8BCAE7","#AB4057","#99DDB4","#FCA4A1","#919191","#BF7080"]}}},"position":{"x":2,"y":44,"width":4,"height":6}},{"widget":{"name":"4a969668","queries":[{"name":"main_query","query":{"datasetName":"763a2da9","fields":[{"name":"sum(read_count)","expression":"SUM(`read_count`)"},{"name":"table_full_name","expression":"`table_full_name`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(read_count)","scale":{"type":"quantitative"},"displayName":"Usage Count"},"y":{"fieldName":"table_full_name","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"Table Name"},"label":{"show":false}},"frame":{"showTitle":true,"title":"Most Popular Tables","showDescription":true,"description":"Identify the 10 most read from tables and see when they were last written to"}}},"position":{"x":0,"y":34,"width":6,"height":7}},{"widget":{"name":"f9046177","queries":[{"name":"main_query","query":{"datasetName":"8d97349c","fields":[{"name":"monthly(usage_date)","expression":"DATE_TRUNC(\"MONTH\", `usage_date`)"},{"name":"sum(usage_count)","expression":"SUM(`usage_count`)"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"line","encodings":{"x":{"fieldName":"monthly(usage_date)","scale":{"type":"temporal"},"displayName":"Period"},"y":{"fieldName":"sum(usage_count)","scale":{"type":"quantitative"},"displayName":"Read Events"}},"frame":{"showTitle":true,"showDescription":true,"title":"Table Usage (Last 12 Months)","description":"See read events for tables over time"}}},"position":{"x":0,"y":24,"width":6,"height":7}},{"widget":{"name":"b78ba2ba","queries":[{"name":"main_query","query":{"datasetName":"1eab9fe1","fields":[{"name":"waf_id","expression":"`waf_id`"},{"name":"implemented","expression":"`implemented`"},{"name":"pillar","expression":"`pillar`"},{"name":"principle","expression":"`principle`"},{"name":"description","expression":"`description`"},{"name":"check_type","expression":"`check_type`"},{"name":"source_object","expression":"`source_object`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"waf_id","title":"waf_id","booleanValues":["false","true"],"type":"string","displayAs":"string","displayName":"waf_id"},{"fieldName":"implemented","title":"implemented","booleanValues":["false","true"],"type":"string","displayAs":"string","displayName":"implemented"},{"fieldName":"pillar","title":"pillar","booleanValues":["false","true"],"type":"string","displayAs":"string","displayName":"pillar"},{"fieldName":"principle","title":"principle","booleanValues":["false","true"],"type":"string","displayAs":"string","displayName":"principle"},{"fieldName":"description","title":"description","booleanValues":["false","true"],"type":"string","displayAs":"string","displayName":"description"},{"fieldName":"check_type","title":"check_type","booleanValues":["false","true"],"type":"string","displayAs":"string","displayName":"check_type"},{"fieldName":"source_object","title":"source_object","booleanValues":["false","true"],"type":"string","displayAs":"string","displayName":"source_object"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"title":"WAF Controls Table","showTitle":true}}},"position":{"x":0,"y":10,"width":6,"height":6}},{"widget":{"name":"ca7cc5ad","queries":[{"name":"main_query","query":{"datasetName":"95258030","fields":[{"name":"sum(completion_percent)","expression":"SUM(`completion_percent`)"},{"name":"principle","expression":"`principle`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(completion_percent)","scale":{"type":"quantitative"},"displayName":"Sum of completion_percent"},"y":{"fieldName":"principle","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"principle"}},"frame":{"title":"Completion percentage of implemented controls per principle","showTitle":true}}},"position":{"x":0,"y":4,"width":6,"height":6}},{"widget":{"name":"4b2ce052","queries":[{"name":"main_query","query":{"datasetName":"920a8759","fields":[{"name":"avg(completion_percent)","expression":"AVG(`completion_percent`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"avg(completion_percent)","displayName":"Average completion_percent"}},"frame":{"title":"Completion Percentage","showTitle":true}}},"position":{"x":0,"y":2,"width":6,"height":2}}],"pageType":"PAGE_TYPE_CANVAS"},{"name":"d88f271c","displayName":"Interoperability & Usability","layout":[{"widget":{"name":"96149840","textbox_spec":"# Interoperability & Usability"},"position":{"x":0,"y":0,"width":6,"height":2}},{"widget":{"name":"036dc3f7","queries":[{"name":"main_query","query":{"datasetName":"c19487ca","fields":[{"name":"waf_id","expression":"`waf_id`"},{"name":"principle","expression":"`principle`"},{"name":"practice","expression":"`practice`"},{"name":"source_object","expression":"`source_object`"},{"name":"implemented","expression":"`implemented`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"waf_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"waf_id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"waf_id"},{"fieldName":"principle","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100001,"title":"principle","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"principle"},{"fieldName":"practice","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100002,"title":"practice","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"practice"},{"fieldName":"source_object","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100003,"title":"source_object","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"source_object"},{"fieldName":"implemented","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100004,"title":"implemented","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"implemented"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"title":"WAF Controls Table","showTitle":true}}},"position":{"x":0,"y":10,"width":6,"height":8}},{"widget":{"name":"8953ae16","queries":[{"name":"main_query","query":{"datasetName":"83c64453","fields":[{"name":"sum(completion_percent)","expression":"SUM(`completion_percent`)"},{"name":"principle","expression":"`principle`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(completion_percent)","scale":{"type":"quantitative"},"displayName":"Sum of completion_percent"},"y":{"fieldName":"principle","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"principle"}},"frame":{"title":"Completion percentage of implemented controls per principle","showTitle":true}}},"position":{"x":0,"y":4,"width":6,"height":6}},{"widget":{"name":"e831cd84","queries":[{"name":"main_query","query":{"datasetName":"05c16819","fields":[{"name":"avg(completion_percent)","expression":"AVG(`completion_percent`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"avg(completion_percent)","displayName":"Average completion_percent"}},"frame":{"title":"Completion Percentage","showTitle":true}}},"position":{"x":0,"y":2,"width":6,"height":2}}],"pageType":"PAGE_TYPE_CANVAS"},{"name":"e290aac3","displayName":"Cost  Optimisation","layout":[{"widget":{"name":"96877a12","textbox_spec":"# Cost Optimisation"},"position":{"x":0,"y":0,"width":6,"height":2}},{"widget":{"name":"42a0abd4","queries":[{"name":"main_query","query":{"datasetName":"dbdc9433","fields":[{"name":"waf_id","expression":"`waf_id`"},{"name":"principle","expression":"`principle`"},{"name":"best_practice","expression":"`best_practice`"},{"name":"implemented","expression":"`implemented`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"waf_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"waf_id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"waf_id"},{"fieldName":"principle","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100001,"title":"principle","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"principle"},{"fieldName":"best_practice","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100002,"title":"best_practice","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"best_practice"},{"fieldName":"implemented","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100003,"title":"implemented","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"implemented"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"title":"WAF Controls Table","showTitle":true}}},"position":{"x":0,"y":10,"width":6,"height":7}},{"widget":{"name":"35c49ee2","queries":[{"name":"main_query","query":{"datasetName":"81f0a6aa","fields":[{"name":"sum(completion_percent)","expression":"SUM(`completion_percent`)"},{"name":"principle","expression":"`principle`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(completion_percent)","scale":{"type":"quantitative"},"displayName":"Sum of completion_percent"},"y":{"fieldName":"principle","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"principle"}},"frame":{"title":"Completion percentage of implemented controls per principle","showTitle":true}}},"position":{"x":0,"y":4,"width":6,"height":6}},{"widget":{"name":"04def979","queries":[{"name":"main_query","query":{"datasetName":"06f2987c","fields":[{"name":"avg(completion_percent)","expression":"AVG(`completion_percent`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"avg(completion_percent)","displayName":"Average completion_percent"}},"frame":{"title":"Completion Percentage","showTitle":true}}},"position":{"x":0,"y":2,"width":6,"height":2}},{"widget":{"name":"4c37a8d4","textbox_spec":"---"},"position":{"x":0,"y":17,"width":6,"height":1}},{"widget":{"name":"f08e62cb","textbox_spec":"### Principle"},"position":{"x":0,"y":18,"width":1,"height":1}},{"widget":{"name":"0b04dde5","textbox_spec":"### Signal"},"position":{"x":1,"y":18,"width":5,"height":1}},{"widget":{"name":"24e2c544","textbox_spec":"#### CO-01-01\n&nbsp;\n\n**Use performance optimized data formats ([Delta Lake](https://docs.databricks.com/aws/en/delta/))**\n\n1. What file formats do you use and why? If not using Delta, what prevents you from defaulting to Delta Lake?\n\n2. What clients/connectors do you use and do they support Delta Lake?"},"position":{"x":0,"y":19,"width":1,"height":6}},{"widget":{"name":"e357302e","queries":[{"name":"main_query","query":{"datasetName":"a5da7a83","fields":[{"name":"sum(no_of_tables)","expression":"SUM(`no_of_tables`)"},{"name":"tables_format","expression":"`tables_format`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"pie","encodings":{"angle":{"fieldName":"sum(no_of_tables)","scale":{"type":"quantitative"},"displayName":"Table formats"},"color":{"fieldName":"tables_format","scale":{"type":"categorical"},"legend":{"hideTitle":true},"displayName":"tables_format"},"label":{"show":true}},"frame":{"showTitle":false}}},"position":{"x":1,"y":19,"width":3,"height":6}},{"widget":{"name":"009b71f1","queries":[{"name":"main_query","query":{"datasetName":"c436a496","fields":[{"name":"sum(percent_of_tables)","expression":"SUM(`percent_of_tables`)"},{"name":"table_type","expression":"`table_type`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"pie","encodings":{"angle":{"fieldName":"sum(percent_of_tables)","scale":{"type":"quantitative"},"displayName":"Table types"},"color":{"fieldName":"table_type","scale":{"type":"categorical"},"legend":{"hideTitle":true},"displayName":"table_type"},"label":{"show":true}}}},"position":{"x":4,"y":19,"width":2,"height":6}},{"widget":{"name":"13fed61c","textbox_spec":"#### CO-01-02\n&nbsp;\n\n**Use job clusters ([Databricks Workflows](https://www.databricks.com/product/data-engineering/workflows))**\n\n1. How you instruct users to run Jobs on Jobs clusters instead of All Purpose?"},"position":{"x":0,"y":26,"width":1,"height":6}},{"widget":{"name":"0b0c4104","textbox_spec":"---"},"position":{"x":0,"y":25,"width":6,"height":1}},{"widget":{"name":"f58e6ab1","queries":[{"name":"main_query","query":{"datasetName":"feca6b37","fields":[{"name":"job_id","expression":"`job_id`"},{"name":"cluster_id","expression":"`cluster_id`"},{"name":"cluster_name","expression":"`cluster_name`"},{"name":"owned_by","expression":"`owned_by`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"job_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":1,"title":"job_id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"job_id"},{"fieldName":"cluster_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":2,"title":"cluster_id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"cluster_id"},{"fieldName":"cluster_name","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":3,"title":"cluster_name","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"cluster_name"},{"fieldName":"owned_by","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":4,"title":"owned_by","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"owned_by"}]},"invisibleColumns":[{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"workspace_id","type":"string","displayAs":"string","order":0,"title":"workspace_id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"dbr_version","type":"string","displayAs":"string","order":5,"title":"dbr_version","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false}],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"showTitle":true,"title":"These jobs are configured to run on All Purpose clusters instead of Job clusters:"}}},"position":{"x":1,"y":26,"width":5,"height":6}},{"widget":{"name":"8c1af4a6","textbox_spec":"---"},"position":{"x":0,"y":32,"width":6,"height":1}},{"widget":{"name":"d232cb60","textbox_spec":"#### CO-01-03\n&nbsp;\n\n**[SQL Warehouses](https://docs.databricks.com/en/sql/admin/sql-warehouse.html) for SQL workloads**\n\n1. Do do you instruct users to use cheaper DBSQL Warehouse instead of All-Purpose for SQL queries and BI?"},"position":{"x":0,"y":33,"width":1,"height":6}},{"widget":{"name":"67085075","queries":[{"name":"main_query","query":{"datasetName":"898f3132","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":4,"y":33,"width":2,"height":6}},{"widget":{"name":"99b1a37d","queries":[{"name":"main_query","query":{"datasetName":"d654eb5a","fields":[{"name":"sum(dbu)","expression":"SUM(`dbu`)"},{"name":"billing_origin_product","expression":"`billing_origin_product`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"pie","encodings":{"angle":{"fieldName":"sum(dbu)","scale":{"type":"quantitative"},"displayName":"DBU (not $DBU)"},"color":{"fieldName":"billing_origin_product","scale":{"type":"categorical"},"displayName":"billing_origin_product"},"label":{"show":true}}}},"position":{"x":1,"y":33,"width":3,"height":6}},{"widget":{"name":"cb9c0e9e","textbox_spec":"---"},"position":{"x":0,"y":39,"width":6,"height":1}},{"widget":{"name":"eb0316c3","textbox_spec":"#### CO-01-04\n&nbsp;\n\n**Use up-to-date [Runtimes](https://docs.databricks.com/aws/en/release-notes/runtime/) for your workloads**\n\n1. How do your project teams operate - do they have freedom to choose the DBR version or is it centralized (eg via automation)?\n\n1. How do you decide when to upgrade to the next runtime version, for example LTS? What is your change management process?"},"position":{"x":0,"y":40,"width":1,"height":6}},{"widget":{"name":"a1e036b9","queries":[{"name":"main_query","query":{"datasetName":"f4e7201f","fields":[{"name":"sum(count)","expression":"SUM(`count`)"},{"name":"version","expression":"`version`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"pie","encodings":{"angle":{"fieldName":"sum(count)","scale":{"type":"quantitative"},"displayName":" "},"color":{"fieldName":"version","scale":{"type":"categorical"},"displayName":"version"},"label":{"show":true}},"frame":{"title":"Version Distribution","showTitle":true,"headerAlignment":"center","showDescription":false}}},"position":{"x":1,"y":40,"width":3,"height":6}},{"widget":{"name":"286ce2b0","textbox_spec":"---"},"position":{"x":0,"y":46,"width":6,"height":1}},{"widget":{"name":"72f7cf44","textbox_spec":"#### CO-01-05\n&nbsp;\n\n**Only use [GPUs](https://docs.databricks.com/aws/en/compute/gpu) for the right workloads**\n\n1. How do your project teams operate - do they have freedom to choose the DBR version or is it centralized (eg via automation)?\n\n1. How do you decide when to upgrade to the next runtime version, for example LTS? What is your change management process?"},"position":{"x":0,"y":47,"width":1,"height":6}},{"widget":{"name":"0ac81fcb","queries":[{"name":"main_query","query":{"datasetName":"62126ae8","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":47,"width":3,"height":6}},{"widget":{"name":"6283c9d0","textbox_spec":"---"},"position":{"x":0,"y":53,"width":6,"height":1}},{"widget":{"name":"9329ad14","textbox_spec":"#### CO-01-06\n&nbsp;\n\n**Use [Serverless](https://docs.databricks.com/aws/en/compute/serverless/) for your workloads**\n\n1. What is your guidance on Serverless for your users?\n\n1. If not done yet, what prevents you from adopting Serverless as the default?\n\n1. Is the team trained to know the difference between Cost Optimized and Performance Optimized Serverless?"},"position":{"x":0,"y":54,"width":1,"height":5}},{"widget":{"name":"cd40aa5d","queries":[{"name":"main_query","query":{"datasetName":"a36b2899","fields":[{"name":"serverless_dbu_percent","expression":"`serverless_dbu_percent`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"serverless_dbu_percent","format":{"type":"number-plain","abbreviation":"compact","decimalPlaces":{"type":"max","places":0}},"displayName":"serverless_dbu_percent"}},"frame":{"showTitle":true,"title":"Serverless adoption (in JOBS, ALL_PURPOSE, INTERACTIVE, DLT and SQL)","headerAlignment":"center","showDescription":true,"description":"Unit is %. The Product does not let me to update the title at the moment ^^"}}},"position":{"x":1,"y":54,"width":3,"height":5}},{"widget":{"name":"f67dc9c5","textbox_spec":"---"},"position":{"x":0,"y":59,"width":6,"height":1}},{"widget":{"name":"fcb831ad","textbox_spec":"#### CO-01-07\n&nbsp;\n\n**Use the right instance type**\n\n1. How do you choose the VM type?\n\n1. How do you monitor the VM/clusters utilization? / Are you aware of the built-in metrics monitoring in Clusters and System tables?"},"position":{"x":0,"y":60,"width":1,"height":5}},{"widget":{"name":"62567a67","queries":[{"name":"main_query","query":{"datasetName":"efb892e1","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":60,"width":3,"height":5}},{"widget":{"name":"62314c18","textbox_spec":"---"},"position":{"x":0,"y":65,"width":6,"height":1}},{"widget":{"name":"4506b67a","textbox_spec":"#### CO-01-08\n&nbsp;\n\n**Choose the most [efficient cluster size](https://docs.databricks.com/aws/en/lakehouse-architecture/cost-optimization/best-practices#choose-the-most-efficient-cluster-size)**\n\n1. How do you use to select optimal worker nodes, sizes and types? Are you aware of instance fleets(only in classic)?\n\n1. Have you attended training/trained your team on Apache Spark Optimization?"},"position":{"x":0,"y":66,"width":1,"height":6}},{"widget":{"name":"0d1674a4","queries":[{"name":"main_query","query":{"datasetName":"1de7073d","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":66,"width":2,"height":6}},{"widget":{"name":"4290b1ba","textbox_spec":"---"},"position":{"x":0,"y":72,"width":6,"height":1}},{"widget":{"name":"72d9583b","textbox_spec":"#### CO-01-09\n&nbsp;\n\n**Evaluate performance optimized query engines with [Photon](https://docs.databricks.com/aws/en/compute/configure#use-photon-acceleration)**\n\n1. How do you choose Photon on/off? Do you know that Photon is just one button to enable on/off and recommended for CPU-bounded workloads and not recommended for classic AllPurpose?\n\n1. Did you know that Photon is included in Serverless, both DBSQL and GC?\n"},"position":{"x":0,"y":73,"width":1,"height":7}},{"widget":{"name":"a9ea23dd","queries":[{"name":"main_query","query":{"datasetName":"951a00c5","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":73,"width":3,"height":7}},{"widget":{"name":"b12b9ae5","queries":[{"name":"main_query","query":{"datasetName":"31958c67","fields":[{"name":"cpu_usage_percent_p75","expression":"`cpu_usage_percent_p75`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"cpu_usage_percent_p75","format":{"type":"number-plain","abbreviation":"none","decimalPlaces":{"type":"max","places":0}},"displayName":"cpu_usage_percent_p75"}},"frame":{"showTitle":true,"title":"P75 CPU utilization in %"}}},"position":{"x":3,"y":66,"width":3,"height":3}},{"widget":{"name":"b7cf3cb8","queries":[{"name":"main_query","query":{"datasetName":"31958c67","fields":[{"name":"memory_usage_percent_p75","expression":"`memory_usage_percent_p75`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"memory_usage_percent_p75","displayName":"memory_usage_percent_p75"}},"frame":{"showTitle":true,"title":"P75 Memory utitlization in %"}}},"position":{"x":3,"y":69,"width":3,"height":3}},{"widget":{"name":"e49c6507","textbox_spec":"---"},"position":{"x":0,"y":80,"width":6,"height":1}},{"widget":{"name":"a4a15f20","textbox_spec":"#### CO-02-01\n&nbsp;\n\n**Leverage [auto-scaling](https://docs.databricks.com/aws/en/compute/configure#enable-autoscaling) compute**\n\n1. What SLAs your queries need to meet?\n\n1. Do you have estimates for maximum concurrent queries/throughput and applied those as auto-scaling configuration?"},"position":{"x":0,"y":81,"width":1,"height":5}},{"widget":{"name":"f8666e94","queries":[{"name":"main_query","query":{"datasetName":"b54341e5","fields":[{"name":"autoscaling_percent","expression":"`autoscaling_percent`"}],"disaggregated":true}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"autoscaling_percent","displayName":"autoscaling_percent"}},"frame":{"showTitle":true,"title":"% of clusters with auto-scaling enabled"}}},"position":{"x":1,"y":81,"width":3,"height":5}},{"widget":{"name":"94a246b7","textbox_spec":"---"},"position":{"x":0,"y":86,"width":6,"height":1}},{"widget":{"name":"3aaf7e8b","textbox_spec":"#### CO-02-02\n&nbsp;\n\n**Use [auto termination](https://docs.databricks.com/aws/en/compute/configure#automatic-termination)**\n\n1. Can your customers tolerate eventual shutdown of the compute or slower startup time in exchange to save monies?\n\n2. Do you use Policies (separate point) to enforce Auto-Termination or monitoring to alert on long running - possibly forgotten - compute?"},"position":{"x":0,"y":87,"width":1,"height":6}},{"widget":{"name":"2a127d7b","queries":[{"name":"main_query","query":{"datasetName":"d0192813","fields":[{"name":"percent_clusters_without_autoterminations","expression":"`percent_clusters_without_autoterminations`"},{"name":"p_75_auto_termination_minutes","expression":"`p_75_auto_termination_minutes`"},{"name":"max_auto_termination_minutes","expression":"`max_auto_termination_minutes`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"percent_clusters_without_autoterminations","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":0,"title":"percent_clusters_without_autoterminations","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"percent_clusters_without_autoterminations"},{"fieldName":"p_75_auto_termination_minutes","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":1,"title":"p_75_auto_termination_minutes","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"p_75_auto_termination_minutes"},{"fieldName":"max_auto_termination_minutes","numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"integer","displayAs":"number","visible":true,"order":2,"title":"max_auto_termination_minutes","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"max_auto_termination_minutes"}]},"invisibleColumns":[{"numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"count_clusters_without_autoterminations","type":"integer","displayAs":"number","order":3,"title":"count_clusters_without_autoterminations","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false},{"numberFormat":"0","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"name":"count_clusters_with_autoterminations","type":"integer","displayAs":"number","order":4,"title":"count_clusters_with_autoterminations","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false}],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":87,"width":4,"height":6}},{"widget":{"name":"9c7fbc03","textbox_spec":"---"},"position":{"x":0,"y":93,"width":6,"height":1}},{"widget":{"name":"3d5715db","textbox_spec":"#### CO-02-03\n&nbsp;\n\n**Use [compute policies](https://docs.databricks.com/aws/en/admin/clusters/policies) to control costs**\n\n1. Would you welcome guardrails for controling spend and prescribing what users can configure when creating clusters?"},"position":{"x":0,"y":94,"width":1,"height":5}},{"widget":{"name":"ed7d96a4","queries":[{"name":"main_query","query":{"datasetName":"cc24226f","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":94,"width":3,"height":5}},{"widget":{"name":"140f6c6b","textbox_spec":"---"},"position":{"x":0,"y":99,"width":6,"height":1}},{"widget":{"name":"3bf3bcc6","textbox_spec":"#### CO-03-01\n&nbsp;\n\n**Monitor costs**\n\n0. Are you worried about users incurring unexpected costs?\n\n1. How do you monitor Databricks cost including cost from cloud providers?\n\n2. Are you using the built-in [cost monitoring dashboard](https://docs.databricks.com/en/admin/account-settings/usage.html)?\n\n3. Have you setup [budgets](https://docs.databricks.com/en/admin/account-settings/budgets.html ) in Databricks or elsewhere?"},"position":{"x":0,"y":100,"width":1,"height":7}},{"widget":{"name":"0b447804","queries":[{"name":"main_query","query":{"datasetName":"e46a4a40","fields":[{"name":"daily(event_date)","expression":"DATE_TRUNC(\"DAY\", `event_date`)"},{"name":"sum(usage_read)","expression":"SUM(`usage_read`)"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"line","encodings":{"x":{"fieldName":"daily(event_date)","scale":{"type":"temporal"},"displayName":"date (day granularity)"},"y":{"fieldName":"sum(usage_read)","scale":{"type":"quantitative"},"displayName":"Number of usage table reads"}}}},"position":{"x":1,"y":100,"width":3,"height":7}},{"widget":{"name":"a0de1765","textbox_spec":"---"},"position":{"x":0,"y":107,"width":6,"height":1}},{"widget":{"name":"3c21f01a","textbox_spec":"#### CO-03-02\n&nbsp;\n\n**[Tag clusters](https://docs.databricks.com/aws/en/lakehouse-architecture/cost-optimization/best-practices#tag-clusters-for-cost-attribution) for cost attribution**\n\n1. What tagging guidelines exist in your organization?\n\n2. What cost attribution processes based on tags exist?"},"position":{"x":0,"y":108,"width":1,"height":6}},{"widget":{"name":"22d5ba56","queries":[{"name":"main_query","query":{"datasetName":"bb77bb31","fields":[{"name":"count","expression":"`count`"},{"name":"number_of_tags","expression":"`number_of_tags`"}],"disaggregated":true}}],"spec":{"version":3,"widgetType":"pie","encodings":{"angle":{"fieldName":"count","scale":{"type":"quantitative"},"format":{"type":"number-plain","abbreviation":"compact","decimalPlaces":{"type":"max","places":2}},"displayName":"count"},"color":{"fieldName":"number_of_tags","scale":{"type":"categorical","mappings":[{"value":0,"color":{"themeColorType":"visualizationColors","position":4}},{"value":1,"color":{"themeColorType":"visualizationColors","position":8}}],"sort":{"by":"natural-order"}},"displayName":"number_of_tags"},"label":{"show":false}}}},"position":{"x":1,"y":108,"width":3,"height":6}},{"widget":{"name":"40a82523","queries":[{"name":"main_query","query":{"datasetName":"7abec3c3","fields":[{"name":"tag","expression":"`tag`"},{"name":"percent","expression":"`percent`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"tag","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"tag","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"tag"},{"fieldName":"percent","numberFormat":"0.00","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"float","displayAs":"number","visible":true,"order":100001,"title":"percent","allowSearch":false,"alignContent":"right","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"percent"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":4,"y":108,"width":2,"height":6}},{"widget":{"name":"4252c35c","textbox_spec":"---"},"position":{"x":0,"y":114,"width":6,"height":1}},{"widget":{"name":"d4669fcb","textbox_spec":"#### CO-03-03\n&nbsp;\n\n**[Budgets](https://docs.databricks.com/en/admin/account-settings/budgets.html ) and Chargeback**\n\n0. Are you worried about users incurring unexpected costs? \n3. Have you setup [budgets](https://docs.databricks.com/en/admin/account-settings/budgets.html ) in Databricks or custom? \n\n\n1. How do you monitor Databricks cost including cost from cloud providers?\n\n2. Are you using the built-in [cost monitoring dashboard](https://docs.databricks.com/en/admin/account-settings/usage.html)?"},"position":{"x":0,"y":115,"width":1,"height":6}},{"widget":{"name":"e9658fbc","queries":[{"name":"main_query","query":{"datasetName":"9f038f29","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":115,"width":3,"height":6}},{"widget":{"name":"57ce5648","textbox_spec":"---"},"position":{"x":0,"y":121,"width":6,"height":1}},{"widget":{"name":"1baedeb1","textbox_spec":"#### CO-03-04\n&nbsp;\n\n**Share cost reports regularly**\n\n1. How do you share cost with spenders?\n\n2. Do spenders have permissions and training to analyse their spend in Billing Dashboard?\n\n3. What mechanisms do you have in place to detect spikes and remediate them?"},"position":{"x":0,"y":122,"width":1,"height":6}},{"widget":{"name":"ad5219bc","queries":[{"name":"main_query","query":{"datasetName":"e3cd19cf","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":122,"width":3,"height":6}},{"widget":{"name":"d2eee859","textbox_spec":"---"},"position":{"x":0,"y":128,"width":6,"height":1}},{"widget":{"name":"fb74bc19","textbox_spec":"#### CO-03-05\n&nbsp;\n\n**Monitor and manage Delta Sharing egress costs**\n\n1. Do you expect to transfer data across regions?\n \n2. How do you monitor your egress cost budget?\n\n3. Are you using delta sharing?"},"position":{"x":0,"y":129,"width":1,"height":5}},{"widget":{"name":"0a06670c","queries":[{"name":"main_query","query":{"datasetName":"d83ae5eb","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":129,"width":3,"height":5}},{"widget":{"name":"b8490725","textbox_spec":"---"},"position":{"x":0,"y":134,"width":6,"height":1}},{"widget":{"name":"e1ac318b","textbox_spec":"#### CO-04-01\n&nbsp;\n\n**Balance always-on and triggered streaming**\n\n1. What are your use-cases for low latency requirements/SLA and data freshness?\n\n2. How do you train your engineers on batch and streaming?"},"position":{"x":0,"y":135,"width":1,"height":5}},{"widget":{"name":"fdc57e08","queries":[{"name":"main_query","query":{"datasetName":"d0a01e50","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":135,"width":3,"height":5}},{"widget":{"name":"d4ad6eaa","textbox_spec":"---"},"position":{"x":0,"y":140,"width":6,"height":1}},{"widget":{"name":"5a454423","textbox_spec":"#### CO-04-02\n&nbsp;\n\n**Balance between on-demand and capacity excess instances**\n\n1. What is your policy for using Spot instances?\n\n2. Is the team trained to know the difference between Cost Optimized and Performance Optimized Serverless?"},"position":{"x":0,"y":141,"width":1,"height":5}},{"widget":{"name":"fdb2bd9d","queries":[{"name":"main_query","query":{"datasetName":"67073248","fields":[{"name":"message","expression":"`message`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"message","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"message","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"message"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false}},"position":{"x":1,"y":141,"width":3,"height":5}},{"widget":{"name":"cf9364cb","queries":[{"name":"main_query","query":{"datasetName":"aed75aae","fields":[{"name":"list_cost","expression":"`list_cost`"},{"name":"sql_sku_name","expression":"`sql_sku_name`"}],"disaggregated":true}}],"spec":{"version":3,"widgetType":"pie","encodings":{"angle":{"fieldName":"list_cost","scale":{"type":"quantitative"},"displayName":"Serverless in SQL Warehouses"},"color":{"fieldName":"sql_sku_name","scale":{"type":"categorical"},"displayName":"sql_sku_name"},"label":{"show":false}}}},"position":{"x":4,"y":54,"width":2,"height":5}}],"pageType":"PAGE_TYPE_CANVAS"},{"name":"4d045fd5","displayName":"Performance Efficiency","layout":[{"widget":{"name":"3090a1a6","textbox_spec":"# Performance Efficiency"},"position":{"x":0,"y":0,"width":6,"height":2}},{"widget":{"name":"dfe014e3","queries":[{"name":"main_query","query":{"datasetName":"4745a0f9","fields":[{"name":"waf_id","expression":"`waf_id`"},{"name":"principle","expression":"`principle`"},{"name":"best_practice","expression":"`best_practice`"},{"name":"implemented","expression":"`implemented`"}],"disaggregated":true}}],"spec":{"version":1,"widgetType":"table","encodings":{"columns":[{"fieldName":"waf_id","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100000,"title":"waf_id","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"waf_id"},{"fieldName":"principle","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100001,"title":"principle","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"principle"},{"fieldName":"best_practice","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100002,"title":"best_practice","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"best_practice"},{"fieldName":"implemented","booleanValues":["false","true"],"imageUrlTemplate":"{{ @ }}","imageTitleTemplate":"{{ @ }}","imageWidth":"","imageHeight":"","linkUrlTemplate":"{{ @ }}","linkTextTemplate":"{{ @ }}","linkTitleTemplate":"{{ @ }}","linkOpenInNewTab":true,"type":"string","displayAs":"string","visible":true,"order":100003,"title":"implemented","allowSearch":false,"alignContent":"left","allowHTML":false,"highlightLinks":false,"useMonospaceFont":false,"preserveWhitespace":false,"displayName":"implemented"}]},"invisibleColumns":[],"allowHTMLByDefault":false,"itemsPerPage":25,"paginationSize":"default","condensed":true,"withRowNumber":false,"frame":{"title":"WAF Controls Table","showTitle":true}}},"position":{"x":0,"y":10,"width":6,"height":8}},{"widget":{"name":"f60f67db","queries":[{"name":"main_query","query":{"datasetName":"13e29e6c","fields":[{"name":"sum(completion_percent)","expression":"SUM(`completion_percent`)"},{"name":"principle","expression":"`principle`"}],"disaggregated":false}}],"spec":{"version":3,"widgetType":"bar","encodings":{"x":{"fieldName":"sum(completion_percent)","scale":{"type":"quantitative"},"displayName":"Sum of completion_percent"},"y":{"fieldName":"principle","scale":{"type":"categorical","sort":{"by":"x-reversed"}},"displayName":"principle"}},"frame":{"title":"Completion percentage of implemented controls per principle","showTitle":true}}},"position":{"x":0,"y":4,"width":6,"height":6}},{"widget":{"name":"f77e0b79","queries":[{"name":"main_query","query":{"datasetName":"87deca0d","fields":[{"name":"avg(completion_percent)","expression":"AVG(`completion_percent`)"}],"disaggregated":false}}],"spec":{"version":2,"widgetType":"counter","encodings":{"value":{"fieldName":"avg(completion_percent)","displayName":"Average completion_percent"}},"frame":{"title":"Completion Percentage","showTitle":true}}},"position":{"x":0,"y":2,"width":6,"height":2}}],"pageType":"PAGE_TYPE_CANVAS"}],"uiSettings":{"theme":{}}}